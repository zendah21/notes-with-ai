/* Theme variables */
:root {
  --bg: #f7f8fc;
  --fg: #142037;
  --muted: #5c6b86;
  --card: #ffffff;
  --border: #e7ebf3;
  --shadow: 0 1px 2px rgba(16, 24, 40, .06), 0 8px 20px rgba(16,24,40,.06);
  --nav-bg: #0f172a;
  --nav-fg: #f8fafc;
}
[data-theme="dark"] {
  /* Polished dark palette with better contrast */
  --bg: #0b1220;         /* deep navy */
  --fg: #e6e7eb;         /* near white */
  --muted: #9aa4b2;      /* slate/steel */
  --card: #101826;       /* dark card */
  --border: #1e2a3c;     /* subtle outline */
  --shadow: 0 1px 2px rgba(0,0,0,.50), 0 10px 24px rgba(0,0,0,.45);
  --nav-bg: #0b1220;
  --nav-fg: #e6e7eb;
}

/* Base tweaks */
html, body { background: var(--bg); color: var(--fg); font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif; }
.navbar { box-shadow: 0 2px 10px var(--shadow); background: var(--nav-bg) !important; }
.navbar .navbar-brand, .navbar .btn { color: var(--nav-fg); }

/* Cards */
.card { border: 1px solid var(--border); background: var(--card); transition: transform 120ms ease, box-shadow 120ms ease; }
.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}

.card .badge {
  font-weight: 500;
}

/* Badges palette refinement */
.text-bg-secondary { background-color:#e9edf5 !important; color:#344767 !important; }
.text-bg-info { background-color:#d7f1ff !important; color:#0b6b95 !important; }
.text-bg-success { background-color:#d8f5e0 !important; color:#1e7d42 !important; }
.text-bg-warning { background-color:#fff2cc !important; color:#8a6d00 !important; }
.text-bg-danger { background-color:#ffe0e0 !important; color:#a33a3a !important; }
.text-bg-light { background-color:#f7f9fc !important; color:#506079 !important; }
[data-theme="dark"] .text-bg-secondary { background-color:#1e293b !important; color:#d1d8e5 !important; }
[data-theme="dark"] .text-bg-info { background-color:#123247 !important; color:#9bd9ff !important; }
[data-theme="dark"] .text-bg-success { background-color:#0f3a22 !important; color:#a4efbd !important; }
[data-theme="dark"] .text-bg-warning { background-color:#3a2b02 !important; color:#ffd572 !important; }
[data-theme="dark"] .text-bg-danger { background-color:#43111a !important; color:#ffb0bd !important; }
[data-theme="dark"] .text-bg-light { background-color:#101826 !important; color:#9aa4b2 !important; }

/* Grid spacing */
#tasks-grid { row-gap: 1rem; }

/* Header and toolbar */
.page-header { margin-bottom: 1rem; }
.page-header h1 { font-size: 1.5rem; margin: 0; }
.muted { color: var(--muted); }
.toolbar .form-select, .toolbar .form-control { min-width: 10rem; }
.toolbar .btn { white-space: nowrap; }

/* Ensure dropdowns inside cards don't affect layout of other cards */
.card { position: relative; overflow: visible; }
.card .dropdown-menu { z-index: 1060; }
.toolbar .dropdown-menu { z-index: 1060; }

/* Command bar */
#ai-cmd:focus { box-shadow: 0 0 0 .2rem rgba(25,135,84,.25); }
#ai-send { box-shadow: none; }

/* Status pill under command bar */
#ai-status {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 999px;
  background: #eef3ff;
  color: #2a3b6b;
}
[data-theme="dark"] #ai-status { background:#1e293b; color:#c7d2fe; }

/* Help page list spacing */
.container ul { margin-bottom: .75rem; }

/* Priority accents on cards */
.card.card-pr-low { border-top: 4px solid #94a3b8; }
.card.card-pr-medium { border-top: 4px solid #64748b; }
.card.card-pr-high { border-top: 4px solid #f59f00; }
.card.card-pr-urgent { border-top: 4px solid #e03131; }
[data-theme="dark"] .card.card-pr-low { border-top-color:#475569; }
[data-theme="dark"] .card.card-pr-medium { border-top-color:#3b516c; }
[data-theme="dark"] .card.card-pr-high { border-top-color:#e7a400; }
[data-theme="dark"] .card.card-pr-urgent { border-top-color:#d13a3a; }

/* Details summary styling */
details > summary {
  list-style: none;
}
details > summary::-webkit-details-marker { display: none }
details > summary::after {
  content: "âœŽ";
  margin-left: .5rem;
}

/* HTMX indicator & toasts */
.hx-indicator { display:none; }
.htmx-request .hx-indicator { display:inline-block; }
.toast-wrap { position: fixed; right: 16px; top: 76px; z-index: 1080; display:flex; flex-direction:column; gap:.5rem; }
.toast-item { opacity: 0; transform: translateY(-6px); transition: all .2s ease; padding: .5rem .75rem; border-radius: .5rem; background: var(--card); border:1px solid var(--border); color: var(--fg); box-shadow: 0 4px 12px var(--shadow); }
.toast-item.visible { opacity: 1; transform: translateY(0); }
.toast-item.danger { border-color:#e03131; }
